# log dir 
log_dir: ./zhiyuanyan/logs/benchv2/icml25/release

# model setting
model_name: gend
backbone_name: vit_large_patch14_clip # Sử dụng CLIP ViT-L/14 theo bài báo [cite: 45]

# backbone setting
backbone_config:
  mode: original
  num_classes: 2
  inc: 3
  dropout: false
  # Quan trọng: Chỉ fine-tune LayerNorm (0.03% params) [cite: 3, 50]

# dataset
all_dataset: [FaceForensics++, FF-F2F, FF-DF, FF-FS, FF-NT, FaceShifter, DeepFakeDetection, Celeb-DF-v1, Celeb-DF-v2, DFDCP, DFDC, DeeperForensics-1.0, UADFV]
train_dataset: [FaceForensics++]
# Bài báo khuyến nghị dùng Paired Data (Real-Fake từ cùng 1 video nguồn) để đạt hiệu quả cao nhất [cite: 5, 22, 75, 76]
test_dataset: [Celeb-DF-v2, FaceShifter, DeeperForensics-1.0]

compression: c23
train_batchSize: 128 # Khớp với bài báo [cite: 59]
test_batchSize: 128
workers: 8
frame_num: {'train': 8, 'test': 32} # Test sử dụng 32 frames để đạt AUROC tốt nhất [cite: 62, 66]
resolution: 224
with_mask: false
with_landmark: false

# data augmentation [cite: 73]
use_data_augmentation: true
data_aug:
  flip_prob: 0.5
  rotate_prob: 0.5
  rotate_limit: [-10, 10]
  blur_prob: 0.5
  blur_limit: [3, 7]
  brightness_prob: 0.5
  brightness_limit: [-0.1, 0.1]
  contrast_limit: [-0.1, 0.1]
  quality_lower: 40
  quality_upper: 100
  # Lưu ý bài báo có nhắc đến JPEG compression augmentation [cite: 73]

# mean and std cho CLIP [cite: 45, 60]
mean: [0.48145466, 0.4578275, 0.40821073]
std: [0.26862954, 0.26130258, 0.27577711]

# optimizer config [cite: 55]
optimizer:
  type: adam
  adam:
    lr: 0.0003 # Peak learning rate là 3e-4 
    beta1: 0.9
    beta2: 0.999
    eps: 0.00000001
    weight_decay: 0.0 # Bài báo ghi rõ: "without weight decay" [cite: 55]
    amsgrad: false

# training config
# Bài báo sử dụng Cosine cyclic rule với 1 epoch warm-up [cite: 56, 57]
lr_scheduler: cosine
warmup_epochs: 1 # Warmup từ 1e-5 lên 3e-4 trong 1 epoch 
lr_T_max: 20         # Chu kỳ giảm LR kéo dài ra
lr_eta_min: 0.00001
nEpochs: 20          # Tăng từ 15 lên 20 để LayerNorm và SVD kịp phối hợp
start_epoch: 0


nEpochs: 20 # Train trong 2 cycles (tổng 20 epochs) [cite: 58]
start_epoch: 0
save_epoch: 1
rec_iter: 100
manualSeed: 1024 # Bài báo lặp lại 5 lần với các seed khác nhau [cite: 89, 95]
save_ckpt: true
save_feat: true

# loss function [cite: 51]
# L = L_CE + alpha*L_align + beta*L_unif
loss_func: cross_entropy

lambda_align: 0.1 # Hệ số alpha cho CLIP ViT-L/14 [cite: 60]
lambda_unif: 0.5 # Hệ số beta cho CLIP ViT-L/14 [cite: 60]

# metric
metric_scoring: auc # AUROC là metric chính [cite: 4, 99]

# cuda
ngpu: 1
cuda: true
cudnn: true

save_avg: true
